<?xml version="1.0"?>

<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <!--File includes-->
  <xacro:include filename="$(find talos_description)/urdf/deg_to_rad.xacro" />
  <xacro:include filename="$(find talos_description)/urdf/gripper/gripper.transmission.xacro" />
  <xacro:include filename="$(find talos_description)/urdf/gripper/gripper.gazebo.xacro" />


  <xacro:macro name="talos_gripper" params="name parent reflect">

           <link name="${name}_base_link">
              <inertial>
                <origin xyz="0.00002800000 0.00539400000 -0.02365400000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.63753400000"/>
                <inertia ixx="0.00058496920" ixy="0.00000437159" ixz="-0.00001258900"
                         iyy="0.00067076439" iyz="0.00002824361"
                         izz="0.00085526645"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/base_link.STL" scale="1 1 1"/>
                </geometry>
                <material name="DarkGrey"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/base_link_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_base_link_joint" type="fixed">
              <parent link="${parent}"/>
              <child link="${name}_base_link"/>
              <origin xyz="0.00000 0.00000 -0.02875"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="0 0 0" />
            </joint>


            <link name="${name}_motor_double_link">
              <inertial>
                <origin xyz="0.01965400000 0.01857200000 -0.01199800000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.13435600000"/>
                <inertia ixx="0.00013479919" ixy="0.00006184429" ixz="-0.00003079800"
                         iyy="0.00019602207" iyz="0.00004707722"
                         izz="0.00024217879"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/gripper_motor_double.STL" scale="1 1 1"/>
                </geometry>
              <material name="Orange"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/gripper_motor_double_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_joint" type="revolute">
              <parent link="${name}_base_link"/>
              <child link="${name}_motor_double_link"/>
              <origin xyz="0.0 0.02025 -0.03"
                      rpy="${0.0 * deg_to_rad} ${0.0 * deg_to_rad} ${0.0 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${-55.0 * deg_to_rad}" upper="${0.0 * deg_to_rad}" effort="1.0" velocity="1.0" />
              <dynamics friction="1.0" damping="1.0"/>
            </joint>


            <link name="${name}_inner_double_link">
              <inertial>
                <origin xyz="-0.01328300000 0.03685200000 -0.02315300000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.08798600000"/>
                <inertia ixx="0.00007410642" ixy="-0.00000074773" ixz="0.00000101536"
                         iyy="0.00012794180" iyz="0.00002504083"
                         izz="0.00010495175"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/inner_double.STL" scale="1 1 1"/>
                </geometry>
              <material name="Orange"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/inner_double_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_inner_double_joint" type="revolute">
              <parent link="${name}_base_link"/>
              <child link="${name}_inner_double_link"/>
              <origin xyz="0.00000 0.00525 -0.05598"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${-60.0 * deg_to_rad}" upper="${0.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${1.0}" offset="0.0" />
            </joint>



            <link name="${name}_fingertip_1_link">
              <inertial>
                <origin xyz="0.00000000000 0.00460400000 -0.00253700000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.02630100000"/>
                <inertia ixx="0.00000800000" ixy="0.00000000000" ixz="0.00000000000"
                         iyy="0.00000869179" iyz="-0.00000143612"
                         izz="0.00000230820"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip.STL" scale="1 1 1"/>
                </geometry>
              <material name="DarkGrey"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>


            <joint name="${name}_fingertip_1_joint" type="revolute">
              <parent link="${name}_inner_double_link"/>
              <child link="${name}_fingertip_1_link"/>
              <origin xyz="0.03200 0.04589 -0.06553"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${0.0 * deg_to_rad}" upper="${60.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${-1.0}" offset="0.0" />
            </joint>


            <link name="${name}_fingertip_2_link">
              <inertial>
                <origin xyz="0.00000000000 0.00460400000 -0.00253700000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.02630100000"/>
                <inertia ixx="0.00000800000" ixy="0.00000000000" ixz="0.00000000000"
                         iyy="0.00000869179" iyz="-0.00000143612"
                         izz="0.00000230820"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip.STL" scale="1 1 1"/>
                </geometry>
                <material name="DarkGrey"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_fingertip_2_joint" type="revolute">
              <parent link="${name}_inner_double_link"/>
              <child link="${name}_fingertip_2_link"/>
              <origin xyz="-0.03200 0.04589 -0.06553"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${0.0 * deg_to_rad}" upper="${60.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${-1.0}" offset="0.0" />
            </joint>


            <link name="${name}_motor_single_link">
              <inertial>
                <origin xyz="0.02523700000 -0.01123100000 -0.00815800000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.10792300000"/>
                <inertia ixx="0.00008973662" ixy="-0.00004082027" ixz="-0.00001927099"
                         iyy="0.00011957255" iyz="-0.00002873284"
                         izz="0.00015469079"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/gripper_motor_single.STL" scale="1 1 1"/>
                </geometry>
              <material name="Orange"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/gripper_motor_single_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_motor_single_joint" type="revolute">
              <parent link="${name}_base_link"/>
              <child link="${name}_motor_single_link"/>
              <origin xyz="0.00000 -0.02025 -0.03000"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${0.0 * deg_to_rad}" upper="${60.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${-1.0}" offset="0.0" />
            </joint>



            <link name="${name}_inner_single_link">
              <inertial>
                <origin xyz="0.00000000000 -0.03456500000 -0.02141200000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.04717700000"/>
                <inertia ixx="0.00004199818" ixy="0.00000013418" ixz="0.00000019358"
                         iyy="0.00003231338" iyz="-0.00001509136"
                         izz="0.00002168842"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/inner_single.STL" scale="1 1 1"/>
                </geometry>
              <material name="Orange"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/inner_single_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_inner_single_joint" type="revolute">
              <parent link="${name}_base_link"/>
              <child link="${name}_inner_single_link"/>
              <origin xyz="0.00000 -0.00525 -0.05598"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${0.0 * deg_to_rad}" upper="${60.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${-1.0}" offset="0.0" />
            </joint>


            <link name="${name}_fingertip_3_link">
              <inertial>
                <origin xyz="0.00000000000 0.00460400000 -0.00253700000" rpy="0.00000000000 0.00000000000 0.00000000000"/>
                <mass value="0.02630100000"/>
                <inertia ixx="0.00000800000" ixy="0.00000000000" ixz="0.00000000000"
                         iyy="0.00000869179" iyz="-0.00000143612"
                         izz="0.00000230820"/>
              </inertial>

              <visual>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip.STL" scale="1 1 1"/>
                </geometry>
              <material name="DarkGrey"/>
              </visual>

              <collision>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <geometry>
                  <mesh filename="package://talos_description/meshes/gripper/fingertip_collision.STL" scale="1 1 1"/>
                </geometry>
              </collision>
            </link>

            <joint name="${name}_fingertip_3_joint" type="revolute">
              <parent link="${name}_inner_single_link"/>
              <child link="${name}_fingertip_3_link"/>
              <origin xyz="0.00000 -0.04589 -0.06553"
                      rpy="${0.00000 * deg_to_rad} ${0.00000 * deg_to_rad} ${180.00000 * deg_to_rad}"/>
              <axis xyz="1 0 0" />
              <limit lower="${0.0 * deg_to_rad}" upper="${60.0 * deg_to_rad}" effort="100.0" velocity="1.0" />
              <mimic joint="${name}_joint" multiplier="${-1.0}" offset="0.0" />
            </joint>



        <xacro:virtual_joints name="${name}" />
        <xacro:gripper_transmission name="${name}" reduction="1.0" />

        <!-- virtual mimic joints -->
<!--         <xacro:gripper_virtual_transmission name="${name}_inner_double" reduction="1.0"/>
        <xacro:gripper_virtual_transmission name="${name}_fingertip_1" reduction="1.0"/>
        <xacro:gripper_virtual_transmission name="${name}_fingertip_2" reduction="1.0"/>
        <xacro:gripper_virtual_transmission name="${name}_inner_single" reduction="1.0"/>
        <xacro:gripper_virtual_transmission name="${name}_motor_single" reduction="1.0"/>
        <xacro:gripper_virtual_transmission name="${name}_fingertip_3" reduction="1.0"/> -->

 </xacro:macro>

</robot>
